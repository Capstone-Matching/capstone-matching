<html>
<head>
	<title>Student Form</title>
	<script type="text/javascript">
		function onCbChange(cb) {
		    var b = document.getElementById(cb).checked;

		    var confirmBox = confirm("You have agreed to Terms and Conditions.");

		    if (confirmBox == true) {
		        if (b) {
		            document.getElementById(cb).checked = true;
		        } else {
		            document.getElementById(cb).checked = false;
		        }
		    } else {
		        
		        document.getElementById(cb).checked = !b;
		    };
		}
	</script>
</head>

<body>
	<div class="container mt-3">
      <div class="d-flex justify-content-between align-items-center">
        <button class="btn btn-danger custom-maroon-button" id="dark-mode-toggle">Toggle Dark Mode</button>
        <%= button_to "Logout", logout_path, { class: "btn btn-danger custom-maroon-button", data: { turbo: "false" }, method: :get } %>
      </div>
    </div>
	<%= render 'shared/notification' %>
	<div class="container">
		<div class="row">
			<div class="col-md-8 offset-md-2">
				<h1 class="text-center mb-4">CSCE Capstone Project Preference Form</h1>

				<br/>
				<p>Howdy! Let us know which company sponsored projects you are interested in.</p>
				<p>This form is open from <%= @form_open.strftime("%B %d, %Y %I:%M %p") %> to <%= @form_close.strftime("%B %d, %Y %I:%M %p") %></p>
				<br/>

				<h4>Student Information</h4>
				<br/>
				<form action="/studentform" method="post">
					<div class="form-group mb-3">
						<label for="email">TAMU Email Address<span class="text-danger">*</span></label>
						<input type="email" class="form-control" id="email" name="email" placeholder="Enter your TAMU email address" required>
					</div>
					<div class="form-group mb-3">
						<label for="last-name">Last Name<span class="text-danger">*</span></label>
						<input type="text" class="form-control" id="last_name" name="last_name" placeholder="Enter your last name" required>
					</div>
					<div class="form-group mb-3">
						<label for="first-name">First Name<span class="text-danger">*</span></label>
						<input type="text" class="form-control" id="first_name" name="first_name" placeholder="Enter your first name" required>
					</div>
					<div class="form-group mb-3">
						<label for="UIN">UIN<span class="text-danger">*</span></label>
						<input type="text" class="form-control" id="uin" name="uin" placeholder="UIN">
					</div>

					<%= render 'shared/gender_selector'%>

					<%= render 'shared/course_selector'%>
					
					<%= render 'shared/work_auth_selector'%>

					<%= render 'shared/contract_sign_selector'%>
					
					<%= render 'shared/nationality_selector'%>
				  	
					<%= render 'shared/ethnicity_selector'%>

					<!-- <div class="form-group mb-3">
						<%= form_with(url: '/devtest/upload_resume', multipart: true) do |form| %>
						  <%= form.label :resume, 'Upload Resume (PDF): ' %>
						  <br/>
						  <%= form.file_field :resume %>
						<% end %>

						<% if flash[:resume_text].present? %>
						  <h2>Resume Text</h2>
						  <pre><%= flash[:resume_text] %></pre>
						<% end %>

						<% if flash[:error].present? %>
						  <p class="error"><%= flash[:error] %></p>
						<% end %>
				  	</div> -->

					<br/><hr/>
					<h4>Project Preferences</h4>
					<p>Please rank a minimum of <%= @min_number %> projects and a maximum of <%= @max_number %> projects. You can only have 1 project for each rank. Leave the field blank if you do not want the project at all.</p>
					<br/>

					<%= render 'shared/project_ranking_table'%>
					


					<script>
					    // JavaScript to disable selected options in project dropdowns
					    const projectDropdowns = document.querySelectorAll('.project-dropdown');

					    projectDropdowns.forEach((dropdown, index) => {
					        dropdown.addEventListener('change', (event) => {
					            const selectedValue = event.target.value;
					            projectDropdowns.forEach((otherDropdown, otherIndex) => {
					                if (otherIndex !== index) {
					                    const optionToDisable = otherDropdown.querySelector(`option[value="${selectedValue}"]`);
					                    if (optionToDisable) {
					                        optionToDisable.disabled = true;
					                    }
					                }
					            });
					        });
					    });
					</script>
					<br/>
					<hr>
					<div class="form-group mb-3">
						<input type="checkbox" name="cbox" id="cbox" onchange="onCbChange('cbox')"> I agree that my information can be stored and used by a professor for project matching.</input>
					</div>	
					<div class="text-center mt-4">
						<button type="submit" class="btn btn-danger custom-maroon-button">Submit</button>
					</div>
				</form>
				<hr>
			</div>
		</div>
	</div>
</body>
</html>